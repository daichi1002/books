# 現役 IT 企業で働くエンジニアが AWS ECS の基礎から応用までカバー。コンテナを使ったアプリケーション開発の基礎から応用まで全て身につけます。

## コンテナによるアプリケーション開発の基本

### AWS ECS とは

Amazon ECS は完全に管理されたコンテナオーケストレーションサービスであり、コンテナ化されたアプリケーションを簡単にデプロイ、管理、およびスケールするのに役立ちます。

#### コンテナとは？

貨物船に使われるコンテナをイメージ。アプリケーションとそれに必要な周辺ソフトウェアをパッケージ化したもの。

#### スケーリングとは？

システム利用者の増大に応じて、システム規模を拡大縮小すること。スケーラビリティ＝スケールのしやすさ。

### ECS の基本構造

クラスター：コンテナを配置する複数の EC2、Fargate、外部インスタンスで構成される要素。クラスター内には、複数のタスクが配置され、それぞれが独自のコンテナを実行。

サービス：クラスター内で実行中のタスクを管理する。

タスク定義：タスクを構成するコンテナ群の定義。CPU やメモリをどのように割り当てるかなど。

タスク：タスク定義に基づいて起動するコンテナの集まりのこと。

## AWS におけるネットワーク入門

### AWS VPC とは？

AWS 上に自由に作成できる専用の仮想ネットワーク環境。この VPC の上に自分たちのデータベースやアプリサーバーを配置していく。土台になる空間のようなイメージ。

### Subnet とは？

VPC 上の IP アドレス範囲を区切ったネットワーク空間。VPC の中に複数作成することができる。VPC = 国、Subnet = 地区のようなイメージ。

#### プライベート IP アドレス

##### プライベート IP アドレスの範囲

`10.0.0.1` - `10.255.255.255`、
`172.16.0.0` - `172.31.255.255`、
`192.168.0.0` - `192.168.255.255`

##### グローバル IP アドレス

インターネット上で一意なアドレス。このアドレスを使用して、世界中の機器と直接通信することができる。

##### プライベート IP アドレス

特定のネットワーク内でのみ使用されるアドレス。ネットワークが異なれば IP アドレスが重複していても問題なく利用できる。

#### CIDR

ネットワークのアドレスとネットワーク部の範囲を表す記法。利用できる IP アドレス範囲がわかる。`10.0.0.0/28`
![alt text](<スクリーンショット 2024-10-31 8.21.07.png>)

### パブリックサブネット

インターネットに直接アクセスできるサブネット。サーバーはグローバル IP アドレスを持つことで外部からアクセスできる。

### プライベートサブネット

インターネットに直接アクセスできないサブネット。

### ルートテーブル

ルートテーブルとは、VPC 内（サブネット内）の通信を振り分けるルールの一覧こと。1 つのサブネットに対して、1 つのルートテーブルと関連付ける。

### インターネットゲートウェイ

「VPC という閉じられた世界」から「膨大なインターネットの世界へ」とつなぐ門としての役割を担っている。デフォルトのルートテーブルでは、VPC 内しかルーティングが向いていない（プライベートサブネット）。インターネットと直接接続できる状態にできるもの。

### セキュリティグループ

VPN のサーバーなどに紐付けて通信を制御するための仮想ファイヤーウォール。アウトバウンド（出ていく通信）とインバウンド（入ってくる通信）のルールを定義してアクセスを管理する。

1. ホワイトリスト方式：インバウンド・アウトバンドルールに記載のないものは全て不許可
2. 高い柔軟性：許可する対象は IP アドレスのほか、特定のセキュリティグループを持つリソースで指定も可能
3. 即時反映：ルールの変更は全ての関連するインスタンスに即時反映

## Blue/Green デプロイ

Blue/Green デプロイは、新旧のバージョンを並行稼働させることで、ダウンタイムを最小限に抑え、リスクを管理しやすくする方法。AWS CodeDeploy を使って実装する。

1. 新しいアプリのコンテナ(Green)をデプロイする
2. 新しいアプリのコンテナ(Green)が正しく動作することを確認する
3. 新しいアプリのコンテナ(Green)にユーザーからの通信を切り替える
4. 古いアプリのコンテナ(Blue)を削除する

|      | Blue/Green デプロイ                                            | ローリングアップデート                           |
| ---- | -------------------------------------------------------------- | ------------------------------------------------ |
| Good | ダウンタイムの最小化<br>迅速なロールバック<br>安全なテスト環境 | 段階的なデプロイメント<br>リソースの効率的な活用 |
| Bad  | コストの増加<br>管理の複雑さ                                   | ロールバックの複雑さ                             |

## ECS と CI/CD パイプライン

## オートスケーリング

## ECS における状態管理

## マイクロサービスアーキテクチャ入門
